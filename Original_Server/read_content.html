<!doctype html>
<html>
<head>
<style>
 input[type=button]{
    background-color: #0cb7f5;
    padding: 8px 15px;
    border-radius: 2px;
    /* border-bottom: 3px solid #0cb7f5; */
    color: #FFF;
    font-weight: 60px;
    border: 0;
    border-bottom: 3px solid #049ce4;
    text-transform: uppercase;
    font-weight: 600;
    font-family: arial;
    margin: 5px 0 0 0}
</style>
</head>
<body>
<?
// DB 접속 정보
include "__dbconnect.php";

$TBNAME = $_GET['tb'];

// 테이블명을 판단해서 각 메뉴로 이동한다.
switch($TBNAME)
{
    case "bbs1" : $menupage = "menu1.html"; break;
	case "bbs2" : $menupage = "menu2.html"; break;
	case "bbs3" : $menupage = "menu3.html"; break;
	case "bbs4" : $menupage = "menu4.html"; break;
	case "bbs5" : $menupage = "menu5.html"; break;
}

# 쿼리 실행
# 형식 : resource mysqli_query(쿼리문, 연결정보)
$query = "SELECT * FROM $TBNAME WHERE no=" . $_GET['no'];
$result = mysqli_query($connect, $query);

# 데이터 값 구하기
$row = mysqli_fetch_array($result);

# 조회수 값 증가
$count = ++$row['count'] ;
$query2 = "UPDATE $TBNAME SET count=$count WHERE no=" . $_GET['no'];
mysqli_query($connect, $query2);

?>

<script language=JavaScript>

function gopage(page)
{
    // 이동할 페이지를 page 변수에 담는다.
    // page 변수는 다음처럼 문자열을 만든다.
    // delete.html?no=6&tb=bbs1
    var page  = page + "?no=" + <?=$row['no']?> + "&tb=" + '<?=$TBNAME?>' ;
    var str   = <?=$row['no']?> + "번 게시글을 삭제하겠습니까 ?";

    // 디버깅 시 아래 주석을 해제하고 확인한다.
    // alert(page);
    // alert(str);
    // return;
    var yesno = confirm(str);

    if(yesno == true)
        location.href = page;
    else
        return false;
}

</script>

<br>
<table align=center border=1 cellpadding=5 cellspacing=0 width=1000>
<tr align=center>
    <td> 번 호  </td> <td> <?=$row['no']?>      </td>
    <td> 작성자 </td> <td> <?=$row['userid']?>   </td>
</tr>
<tr align=center>
    <td> 작성일 </td> <td> <?=$row['date']?>     </td>
    <td> 조회수 </td>
	<td > <?=$row['count']?>  </td>
</tr>
<tr>
	<td align=center> 파일명 </td>
	<td colspan=3>
			<?
			/*
			 * empty()함수는 존재하는 값이 없거나 변수의 값이 0 또는 false, null값일 
			 * 경우에는 true를 반환한다.
			 */
			if(empty($row['uploadfile'])) // 파일이 업로드가 안되었다면
				echo "&nbsp;";  // 공백을 출력한다. (테이블이 깨지지 않게 하기 위해서 필요함)
			else // 파일이 업로드 되었다면 업로드된 파일을 링크시킨다.
				echo "<a href='data/" .  $row['uploadfile'] . "'>" . $row['uploadfile'] . "</a>";
			?>
	</a> </td>
</tr>
<tr>
    <td align=center> 제 목   </td>
    <td colspan=3> <?=$row['title']?>   </td>
</tr>
<tr>
    <td align=center> 내 용   </td>
        <td colspan=3 height=300 valign=top> <?=$row['contents']?> </td>
</tr>
<tr>
    <td  align=center colspan=4>
    <input type="button" value="목록" onClick="location='<?=$menupage?>';">&nbsp;
    <input type="button" value="삭제" onClick="gopage('delete.html');">&nbsp;
    <input type="button" value="수정" onClick="location='edit.html?no=<?=$row['no']?>&tb=<?=$TBNAME?>'">
    </td>
</tr>
</table>
</body>
</html>
